<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zynapse - Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.4/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body class="bg-gray-50">
    <div x-data="mainApp">
        <!-- Mobile menu overlay -->
        <div x-show="mobileMenuOpen" 
             class="fixed inset-0 z-40 lg:hidden" 
             x-transition:enter="transition-opacity ease-linear duration-300"
             x-transition:enter-start="opacity-0"
             x-transition:enter-end="opacity-100"
             x-transition:leave="transition-opacity ease-linear duration-300"
             x-transition:leave-start="opacity-100"
             x-transition:leave-end="opacity-0">
            <div class="fixed inset-0 bg-gray-600 bg-opacity-75" @click="mobileMenuOpen = false"></div>
        </div>

        <!-- Mobile menu -->
        <div x-show="mobileMenuOpen"
             class="fixed inset-y-0 left-0 z-40 w-full bg-white lg:hidden"
             x-transition:enter="transition ease-in-out duration-300 transform"
             x-transition:enter-start="-translate-x-full"
             x-transition:enter-end="translate-x-0"
             x-transition:leave="transition ease-in-out duration-300 transform"
             x-transition:leave-start="translate-x-0"
             x-transition:leave-end="-translate-x-full">
            <div class="flex flex-col h-full">
                <!-- Mobile menu header -->
                <div class="flex items-center justify-between px-4 py-3 border-b border-gray-200">
                    <div class="flex items-center">
                        <img src="assets/img/logo.png" alt="Zynapse Logo" class="h-8">
                        <span class="ml-2 text-xl font-semibold text-indigo-600">Zynapse</span>
                    </div>
                    <button @click="mobileMenuOpen = false" class="text-gray-500 hover:text-gray-700">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                
                <!-- Mobile menu items -->
                <nav class="flex-1 px-2 py-4 space-y-1 overflow-y-auto">
                    <template x-for="(item, index) in menuItems" :key="index">
                        <a :href="item.url" 
                           @click="activeSection = item.id; mobileMenuOpen = false"
                           :class="{'bg-indigo-50 text-indigo-700': activeSection === item.id, 'text-gray-600 hover:bg-gray-50 hover:text-gray-900': activeSection !== item.id}"
                           class="flex items-center px-4 py-3 text-base font-medium rounded-md group">
                            <i :class="[item.icon, activeSection === item.id ? 'text-indigo-500' : 'text-gray-400 group-hover:text-gray-500']" class="flex-shrink-0 w-6 h-6 mr-3"></i>
                            <span x-text="item.name"></span>
                        </a>
                    </template>
                </nav>
                
                <!-- Mobile menu footer -->
                <div class="p-4 border-t border-gray-200">
                    <div class="flex items-center">
                        <div class="flex-shrink-0">
                            <div class="w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center">
                                <span class="text-indigo-600 font-medium text-lg" x-text="userInitials"></span>
                            </div>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm font-medium text-gray-700" x-text="userData.name"></p>
                            <button @click="logout" class="text-xs font-medium text-indigo-600 hover:text-indigo-500">Sair</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Desktop sidebar -->
        <div class="hidden lg:flex lg:flex-col lg:w-64 lg:fixed lg:inset-y-0 lg:border-r lg:border-gray-200 lg:bg-white">
            <!-- Sidebar header -->
            <div class="flex items-center justify-center h-16 px-6 bg-white border-b border-gray-200">
                <img src="assets/img/logo.png" alt="Zynapse Logo" class="h-8">
                <span class="ml-2 text-xl font-semibold text-indigo-600">Zynapse</span>
            </div>
            
            <!-- Sidebar navigation -->
            <nav class="flex-1 px-4 py-6 space-y-1 overflow-y-auto">
                <template x-for="(item, index) in menuItems" :key="index">
                    <a :href="item.url" 
                       @click.prevent="activeSection = item.id"
                       :class="{'bg-indigo-50 text-indigo-700': activeSection === item.id, 'text-gray-600 hover:bg-gray-50 hover:text-gray-900': activeSection !== item.id}"
                       class="flex items-center px-4 py-3 text-sm font-medium rounded-md group">
                        <i :class="[item.icon, activeSection === item.id ? 'text-indigo-500' : 'text-gray-400 group-hover:text-gray-500']" class="flex-shrink-0 w-5 h-5 mr-3"></i>
                        <span x-text="item.name"></span>
                    </a>
                </template>
            </nav>
            
            <!-- Sidebar footer -->
            <div class="flex items-center justify-between px-4 py-4 border-t border-gray-200">
                <div class="flex items-center flex-shrink-0">
                    <div class="w-8 h-8 bg-indigo-100 rounded-full flex items-center justify-center">
                        <span class="text-indigo-600 font-medium" x-text="userInitials"></span>
                    </div>
                    <div class="ml-3">
                        <p class="text-sm font-medium text-gray-700 truncate" x-text="userData.name"></p>
                        <p class="text-xs text-gray-500 truncate" x-text="userData.email"></p>
                    </div>
                </div>
                <button @click="logout" class="text-gray-400 hover:text-gray-500">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </div>

        <!-- Main content -->
        <div class="lg:pl-64">
            <!-- Top header -->
            <div class="sticky top-0 z-10 flex items-center justify-between h-16 px-4 bg-white border-b border-gray-200 sm:px-6 lg:px-8">
                <button @click="mobileMenuOpen = true" class="text-gray-500 lg:hidden">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
                <div class="flex-1 lg:flex lg:items-center lg:justify-between">
                    <div>
                        <h1 class="text-xl font-semibold text-gray-900" x-text="getActiveMenuName()"></h1>
                    </div>
                    <div class="flex items-center space-x-4">
                        <!-- Notifications -->
                        <button class="p-1 text-gray-400 bg-white rounded-full hover:text-gray-500 focus:outline-none">
                            <span class="sr-only">Ver notificações</span>
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
                            </svg>
                        </button>
                        
                        <!-- Help -->
                        <button class="p-1 text-gray-400 bg-white rounded-full hover:text-gray-500 focus:outline-none">
                            <span class="sr-only">Ajuda</span>
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Page content -->
            <main class="p-4 sm:p-6 lg:p-8">
                <!-- Dashboard Section -->
                <div x-show="activeSection === 'dashboard'" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100">
                    <!-- KPI Cards -->
                    <div class="grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4">
                        <!-- Total de Conversas -->
                        <div class="overflow-hidden bg-white rounded-lg shadow">
                            <div class="p-5">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0 p-3 bg-indigo-100 rounded-md">
                                        <i class="text-indigo-600 fas fa-comments"></i>
                                    </div>
                                    <div class="flex-1 w-0 ml-5">
                                        <dl>
                                            <dt class="text-sm font-medium text-gray-500 truncate">Total de Conversas</dt>
                                            <dd class="flex items-baseline">
                                                <div class="text-2xl font-semibold text-gray-900">248</div>
                                                <div class="flex items-baseline ml-2 text-sm font-semibold text-green-600">
                                                    <i class="self-center fas fa-arrow-up"></i>
                                                    <span class="ml-1">12%</span>
                                                </div>
                                            </dd>
                                        </dl>
                                    </div>
                                </div>
                            </div>
                            <div class="px-5 py-3 bg-gray-50">
                                <div class="text-sm">
                                    <a href="#" @click.prevent="activeSection = 'whatsapp'" class="font-medium text-indigo-600 hover:text-indigo-500">Ver todas</a>
                                </div>
                            </div>
                        </div>

                        <!-- Taxa de Resposta -->
                        <div class="overflow-hidden bg-white rounded-lg shadow">
                            <div class="p-5">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0 p-3 bg-green-100 rounded-md">
                                        <i class="text-green-600 fas fa-check-circle"></i>
                                    </div>
                                    <div class="flex-1 w-0 ml-5">
                                        <dl>
                                            <dt class="text-sm font-medium text-gray-500 truncate">Taxa de Resposta</dt>
                                            <dd class="flex items-baseline">
                                                <div class="text-2xl font-semibold text-gray-900">94%</div>
                                                <div class="flex items-baseline ml-2 text-sm font-semibold text-green-600">
                                                    <i class="self-center fas fa-arrow-up"></i>
                                                    <span class="ml-1">3%</span>
                                                </div>
                                            </dd>
                                        </dl>
                                    </div>
                                </div>
                            </div>
                            <div class="px-5 py-3 bg-gray-50">
                                <div class="text-sm">
                                    <a href="#" class="font-medium text-indigo-600 hover:text-indigo-500">Ver detalhes</a>
                                </div>
                            </div>
                        </div>

                        <!-- Tempo Médio de Resposta -->
                        <div class="overflow-hidden bg-white rounded-lg shadow">
                            <div class="p-5">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0 p-3 bg-yellow-100 rounded-md">
                                        <i class="text-yellow-600 fas fa-clock"></i>
                                    </div>
                                    <div class="flex-1 w-0 ml-5">
                                        <dl>
                                            <dt class="text-sm font-medium text-gray-500 truncate">Tempo Médio de Resposta</dt>
                                            <dd class="flex items-baseline">
                                                <div class="text-2xl font-semibold text-gray-900">2.4 min</div>
                                                <div class="flex items-baseline ml-2 text-sm font-semibold text-green-600">
                                                    <i class="self-center fas fa-arrow-down"></i>
                                                    <span class="ml-1">8%</span>
                                                </div>
                                            </dd>
                                        </dl>
                                    </div>
                                </div>
                            </div>
                            <div class="px-5 py-3 bg-gray-50">
                                <div class="text-sm">
                                    <a href="#" class="font-medium text-indigo-600 hover:text-indigo-500">Ver detalhes</a>
                                </div>
                            </div>
                        </div>

                        <!-- Conversões -->
                        <div class="overflow-hidden bg-white rounded-lg shadow">
                            <div class="p-5">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0 p-3 bg-blue-100 rounded-md">
                                        <i class="text-blue-600 fas fa-shopping-cart"></i>
                                    </div>
                                    <div class="flex-1 w-0 ml-5">
                                        <dl>
                                            <dt class="text-sm font-medium text-gray-500 truncate">Conversões</dt>
                                            <dd class="flex items-baseline">
                                                <div class="text-2xl font-semibold text-gray-900">42</div>
                                                <div class="flex items-baseline ml-2 text-sm font-semibold text-green-600">
                                                    <i class="self-center fas fa-arrow-up"></i>
                                                    <span class="ml-1">15%</span>
                                                </div>
                                            </dd>
                                        </dl>
                                    </div>
                                </div>
                            </div>
                            <div class="px-5 py-3 bg-gray-50">
                                <div class="text-sm">
                                    <a href="#" @click.prevent="activeSection = 'campaigns'" class="font-medium text-indigo-600 hover:text-indigo-500">Ver todas</a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Charts -->
                    <div class="grid grid-cols-1 gap-5 mt-8 lg:grid-cols-2">
                        <!-- Conversas por Dia -->
                        <div class="overflow-hidden bg-white rounded-lg shadow">
                            <div class="p-5">
                                <h3 class="text-lg font-medium leading-6 text-gray-900">Conversas por Dia</h3>
                                <div class="mt-2">
                                    <canvas id="conversationsChart" height="200"></canvas>
                                </div>
                            </div>
                        </div>

                        <!-- Desempenho de Campanhas -->
                        <div class="overflow-hidden bg-white rounded-lg shadow">
                            <div class="p-5">
                                <h3 class="text-lg font-medium leading-6 text-gray-900">Desempenho de Campanhas</h3>
                                <div class="mt-2">
                                    <canvas id="campaignsChart" height="200"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="mt-8">
                        <div class="overflow-hidden bg-white rounded-lg shadow">
                            <div class="px-5 py-4 border-b border-gray-200">
                                <h3 class="text-lg font-medium leading-6 text-gray-900">Atividades Recentes</h3>
                            </div>
                            <ul class="divide-y divide-gray-200">
                                <li class="px-5 py-4">
                                    <div class="flex items-center space-x-4">
                                        <div class="flex-shrink-0">
                                            <div class="w-8 h-8 bg-indigo-100 rounded-full flex items-center justify-center">
                                                <i class="text-indigo-600 fas fa-comment"></i>
                                            </div>
                                        </div>
                                        <div class="flex-1 min-w-0">
                                            <p class="text-sm font-medium text-gray-900 truncate">Nova mensagem de João Silva</p>
                                            <p class="text-sm text-gray-500">Gostaria de saber mais sobre o plano Pro</p>
                                        </div>
                                        <div>
                                            <p class="text-sm text-gray-500">5 min atrás</p>
                                        </div>
                                    </div>
                                </li>
                                <li class="px-5 py-4">
                                    <div class="flex items-center space-x-4">
                                        <div class="flex-shrink-0">
                                            <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center">
                                                <i class="text-green-600 fas fa-check"></i>
                                            </div>
                                        </div>
                                        <div class="flex-1 min-w-0">
                                            <p class="text-sm font-medium text-gray-900 truncate">Campanha "Promoção de Verão" iniciada</p>
                                            <p class="text-sm text-gray-500">Enviada para 150 contatos</p>
                                        </div>
                                        <div>
                                            <p class="text-sm text-gray-500">1 hora atrás</p>
                                        </div>
                                    </div>
                                </li>
                                <li class="px-5 py-4">
                                    <div class="flex items-center space-x-4">
                                        <div class="flex-shrink-0">
                                            <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                                                <i class="text-blue-600 fas fa-user"></i>
                                            </div>
                                        </div>
                                        <div class="flex-1 min-w-0">
                                            <p class="text-sm font-medium text-gray-900 truncate">Novo usuário registrado</p>
                                            <p class="text-sm text-gray-500">Maria Oliveira (maria@exemplo.com)</p>
                                        </div>
                                        <div>
                                            <p class="text-sm text-gray-500">3 horas atrás</p>
                                        </div>
                                    </div>
                                </li>
                                <li class="px-5 py-4">
                                    <div class="flex items-center space-x-4">
                                        <div class="flex-shrink-0">
                                            <div class="w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center">
                                                <i class="text-yellow-600 fas fa-robot"></i>
                                            </div>
                                        </div>
                                        <div class="flex-1 min-w-0">
                                            <p class="text-sm font-medium text-gray-900 truncate">Bot WhatsApp reconectado</p>
                                            <p class="text-sm text-gray-500">Conexão restabelecida automaticamente</p>
                                        </div>
                                        <div>
                                            <p class="text-sm text-gray-500">5 horas atrás</p>
                                        </div>
                                    </div>
                                </li>
                            </ul>
                            <div class="px-5 py-4 bg-gray-50">
                                <a href="#" class="text-sm font-medium text-indigo-600 hover:text-indigo-500">Ver todas as atividades</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- WhatsApp Section -->
                <div x-show="activeSection === 'whatsapp'" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-data="whatsappSection">
                    <div class="bg-white shadow rounded-lg">
                        <div class="h-[700px] flex flex-col md:flex-row">
                            <!-- Conversas (Sidebar) -->
                            <div class="w-full md:w-1/3 border-r border-gray-200 flex flex-col">
                                <!-- Barra de pesquisa -->
                                <div class="p-4 border-b border-gray-200">
                                    <div class="relative">
                                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                            <i class="fas fa-search text-gray-400"></i>
                                        </div>
                                        <input 
                                            type="text" 
                                            x-model="searchQuery"
                                            placeholder="Buscar conversas..." 
                                            class="block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
                                        >
                                    </div>
                                </div>
                                
                                <!-- Lista de conversas -->
                                <div class="flex-1 overflow-y-auto">
                                    <template x-if="loading && !selectedConversation">
                                        <div class="p-4 text-center">
                                            <div class="inline-block animate-spin rounded-full h-8 w-8 border-4 border-indigo-500 border-t-transparent"></div>
                                            <p class="mt-2 text-sm text-gray-500">Carregando conversas...</p>
                                        </div>
                                    </template>
                                    
                                    <template x-if="!loading && filteredConversations.length === 0">
                                        <div class="p-4 text-center">
                                            <i class="fas fa-search text-gray-300 text-4xl mb-2"></i>
                                            <p class="text-gray-500">Nenhuma conversa encontrada</p>
                                        </div>
                                    </template>
                                    
                                    <template x-if="!loading">
                                        <div class="conversation-list">
                                            <template x-for="conversation in filteredConversations" :key="conversation.id">
                                                <div 
                                                    @click="selectConversation(conversation.id)"
                                                    :class="{'bg-indigo-50': selectedConversation === conversation.id}"
                                                    class="conversation-item hover:bg-gray-50 cursor-pointer"
                                                >
                                                    <div class="flex items-center">
                                                        <div class="flex-shrink-0">
                                                            <template x-if="conversation.avatar">
                                                                <img :src="conversation.avatar" alt="Avatar" class="h-10 w-10 rounded-full">
                                                            </template>
                                                            <template x-if="!conversation.avatar">
                                                                <div class="h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center">
                                                                    <span class="text-indigo-600 font-medium" x-text="getInitials(conversation.name)"></span>
                                                                </div>
                                                            </template>
                                                        </div>
                                                        <div class="ml-4 flex-1">
                                                            <div class="flex items-center justify-between">
                                                                <h3 class="text-sm font-medium text-gray-900" x-text="conversation.name"></h3>
                                                                <p class="text-xs text-gray-500" x-text="formatDate(conversation.timestamp)"></p>
                                                            </div>
                                                            <div class="flex items-center justify-between mt-1">
                                                                <p class="text-sm text-gray-500 truncate" x-text="conversation.last_message"></p>
                                                                <template x-if="conversation.unread > 0">
                                                                    <span class="inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white bg-indigo-600 rounded-full" x-text="conversation.unread"></span>
                                                                </template>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </template>
                                        </div>
                                    </template>
                                </div>
                            </div>
                            
                            <!-- Chat -->
                            <div class="w-full md:w-2/3 flex flex-col">
                                <template x-if="!selectedConversation">
                                    <div class="empty-state">
                                        <i class="fas fa-comments text-gray-300 text-5xl mb-4"></i>
                                        <h3 class="text-lg font-medium text-gray-900">Selecione uma conversa</h3>
                                        <p class="mt-1 text-sm text-gray-500">Escolha uma conversa para visualizar as mensagens.</p>
                                    </div>
                                </template>
                                
                                <template x-if="selectedConversation">
                                    <div class="flex flex-col h-full">
                                        <!-- Cabeçalho do chat -->
                                        <div class="px-4 py-3 border-b border-gray-200 flex items-center justify-between">
                                            <div class="flex items-center">
                                                <template x-if="conversations.find(c => c.id === selectedConversation)?.avatar">
                                                    <img :src="conversations.find(c => c.id === selectedConversation)?.avatar" alt="Avatar" class="h-8 w-8 rounded-full">
                                                </template>
                                                <template x-if="!conversations.find(c => c.id === selectedConversation)?.avatar">
                                                    <div class="h-8 w-8 rounded-full bg-indigo-100 flex items-center justify-center">
                                                        <span class="text-indigo-600 font-medium" x-text="getInitials(conversations.find(c => c.id === selectedConversation)?.name)"></span>
                                                    </div>
                                                </template>
                                                <div class="ml-3">
                                                    <h3 class="text-sm font-medium text-gray-900" x-text="conversations.find(c => c.id === selectedConversation)?.name"></h3>
                                                    <p class="text-xs text-gray-500" x-text="conversations.find(c => c.id === selectedConversation)?.phone"></p>
                                                </div>
                                            </div>
                                            <div>
                                                <button @click="clearConversation" class="text-gray-400 hover:text-gray-500">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </div>
                                        
                                        <!-- Mensagens -->
                                        <div x-ref="chatContainer" class="flex-1 overflow-y-auto p-4 space-y-4">
                                            <template x-if="loading">
                                                <div class="text-center py-4">
                                                    <div class="inline-block animate-spin rounded-full h-8 w-8 border-4 border-indigo-500 border-t-transparent"></div>
                                                    <p class="mt-2 text-sm text-gray-500">Carregando mensagens...</p>
                                                </div>
                                            </template>
                                            
                                            <template x-if="error">
                                                <div class="error-message">
                                                    <p x-text="error"></p>
                                                </div>
                                            </template>
                                            
                                            <template x-if="!loading && messages.length === 0">
                                                <div class="text-center py-4">
                                                    <i class="fas fa-comment-slash text-gray-300 text-4xl mb-2"></i>
                                                    <p class="text-gray-500">Nenhuma mensagem encontrada</p>
                                                </div>
                                            </template>
                                            
                                            <template x-for="message in messages" :key="message.id">
                                                <div :class="{'message sent': message.sender === 'bot', 'message received': message.sender === 'user'}">
                                                    <p x-text="message.content"></p>
                                                    <div class="message-time" x-text="formatDate(message.timestamp)"></div>
                                                </div>
                                            </template>
                                        </div>
                                        
                                        <!-- Input de mensagem -->
                                        <div class="border-t border-gray-200 p-4">
                                            <form @submit.prevent="sendMessage" class="flex">
                                                <input 
                                                    type="text" 
                                                    x-model="newMessage"
                                                    placeholder="Digite uma mensagem..." 
                                                    class="flex-1 border border-gray-300 rounded-l-md px-4 py-2 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
                                                >
                                                <button 
                                                    type="submit"
                                                    :disabled="!newMessage.trim()"
                                                    class="bg-indigo-600 text-white px-4 py-2 rounded-r-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50"
                                                >
                                                    <i class="fas fa-paper-plane"></i>
                                                </button>
                                            </form>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bot Control Section -->
                <div x-show="activeSection === 'bot_control'" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-data="botControlSection">
                    <div class="bg-white shadow rounded-lg">
                        <div class="p-6">
                            <!-- Status e Controles -->
                            <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-6">
                                <div class="flex items-center mb-4 md:mb-0">
                                    <div class="mr-4">
                                        <div class="flex items-center">
                                            <div :class="{
                                                'bot-status-indicator bot-status-running': botStatus === 'running',
                                                'bot-status-indicator bot-status-stopped': botStatus === 'stopped',
                                                'bot-status-indicator bot-status-loading': botStatus === 'loading'
                                            }" class="mr-2"></div>
                                            <span class="font-medium text-gray-900">Status:</span>
                                            <span class="ml-2" x-text="botStatus === 'running' ? 'Em execução' : botStatus === 'loading' ? 'Iniciando...' : 'Parado'"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="flex space-x-3">
                                    <button 
                                        @click="startBot" 
                                        :disabled="botStatus === 'running' || botStatus === 'loading' || loading"
                                        :class="{'opacity-50 cursor-not-allowed': botStatus === 'running' || botStatus === 'loading' || loading}"
                                        class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"
                                    >
                                        <i class="fas fa-play mr-2"></i>
                                        Iniciar Bot
                                    </button>
                                    <button 
                                        @click="stopBot" 
                                        :disabled="botStatus === 'stopped' || loading"
                                        :class="{'opacity-50 cursor-not-allowed': botStatus === 'stopped' || loading}"
                                        class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"
                                    >
                                        <i class="fas fa-stop mr-2"></i>
                                        Parar Bot
                                    </button>
                                </div>
                            </div>
                            
                            <!-- QR Code e Logs -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <!-- QR Code -->
                                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                                    <h3 class="text-lg font-medium text-gray-900 mb-4">QR Code para Conexão</h3>
                                    <template x-if="botStatus === 'loading' || botStatus === 'running'">
                                        <div class="flex flex-col items-center justify-center">
                                            <template x-if="qrCode">
                                                <div>
                                                    <div id="qrcode" class="flex justify-center"></div>
                                                    <p class="text-sm text-gray-500 text-center mt-4">Escaneie este QR code com seu WhatsApp para conectar o bot</p>
                                                </div>
                                            </template>
                                            <template x-if="!qrCode && botStatus === 'loading'">
                                                <div class="text-center py-10">
                                                    <div class="inline-block animate-spin rounded-full h-10 w-10 border-4 border-indigo-500 border-t-transparent"></div>
                                                    <p class="mt-4 text-sm text-gray-500">Gerando QR code...</p>
                                                </div>
                                            </template>
                                            <template x-if="!qrCode && botStatus === 'running'">
                                                <div class="text-center py-10">
                                                    <div class="rounded-full h-16 w-16 bg-green-100 flex items-center justify-center mx-auto">
                                                        <i class="fas fa-check text-green-600 text-2xl"></i>
                                                    </div>
                                                    <p class="mt-4 text-sm text-gray-900 font-medium">Bot conectado com sucesso!</p>
                                                    <p class="text-sm text-gray-500">O QR code não é mais necessário</p>
                                                </div>
                                            </template>
                                        </div>
                                    </template>
                                    <template x-if="botStatus === 'stopped'">
                                        <div class="text-center py-10">
                                            <div class="rounded-full h-16 w-16 bg-gray-100 flex items-center justify-center mx-auto">
                                                <i class="fas fa-qrcode text-gray-400 text-2xl"></i>
                                            </div>
                                            <p class="mt-4 text-sm text-gray-500">Inicie o bot para gerar um QR code</p>
                                        </div>
                                    </template>
                                </div>
                                
                                <!-- Logs -->
                                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                                    <div class="flex items-center justify-between mb-4">
                                        <h3 class="text-lg font-medium text-gray-900">Logs do Bot</h3>
                                        <button 
                                            @click="refreshLogs" 
                                            class="text-indigo-600 hover:text-indigo-500 focus:outline-none"
                                        >
                                            <i class="fas fa-sync-alt"></i>
                                        </button>
                                    </div>
                                    <div class="logs-container">
                                        <template x-if="logs">
                                            <pre x-text="logs"></pre>
                                        </template>
                                        <template x-if="!logs">
                                            <div class="text-gray-400">Nenhum log disponível</div>
                                        </template>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Configurações Avançadas -->
                            <div class="mt-6">
                                <h3 class="text-lg font-medium text-gray-900 mb-4">Configurações Avançadas</h3>
                                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Delay entre mensagens (ms)</label>
                                            <input type="number" min="0" step="100" value="1000" class="form-input block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
                                            <p class="mt-1 text-xs text-gray-500">Tempo de espera entre mensagens para evitar bloqueio</p>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Reconexão automática</label>
                                            <div class="flex items-center">
                                                <input type="checkbox" checked class="form-checkbox h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500">
                                                <span class="ml-2 text-sm text-gray-700">Ativar reconexão automática</span>
                                            </div>
                                            <p class="mt-1 text-xs text-gray-500">Tenta reconectar automaticamente em caso de desconexão</p>
                                        </div>
                                    </div>
                                    <div class="mt-4">
                                        <button class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                            Salvar Configurações
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- AI Training Section -->
                <div x-show="activeSection === 'ai_training'" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-data="aiTrainingSection">
                    <div class="bg-white shadow rounded-lg">
                        <div class="p-6">
                            <div class="flex items-center justify-between mb-6">
                                <h2 class="text-xl font-semibold text-gray-900">Treinamento da Inteligência Artificial</h2>
                                <button @click="resetToDefault" class="text-sm text-indigo-600 hover:text-indigo-500 focus:outline-none">
                                    <i class="fas fa-undo mr-1"></i> Restaurar Padrão
                                </button>
                            </div>

                            <!-- Mensagens de Sucesso/Erro -->
                            <template x-if="success">
                                <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4" role="alert">
                                    <span class="block sm:inline" x-text="success"></span>
                                </div>
                            </template>
                            <template x-if="error">
                                <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4" role="alert">
                                    <span class="block sm:inline" x-text="error"></span>
                                </div>
                            </template>

                            <!-- Configuração do Prompt -->
                            <div class="mb-8">
                                <h3 class="text-lg font-medium text-gray-900 mb-4">Configuração do Prompt</h3>
                                <div class="space-y-4">
                                    <div>
                                        <label for="personality" class="block text-sm font-medium text-gray-700">Personalidade da IA</label>
                                        <textarea id="personality" x-model="promptData.personality" rows="3" class="form-textarea"></textarea>
                                        <p class="mt-1 text-xs text-gray-500">Descreva a personalidade geral do assistente (ex: amigável, formal, divertido).</p>
                                    </div>
                                    <div>
                                        <label for="knowledge" class="block text-sm font-medium text-gray-700">Base de Conhecimento</label>
                                        <textarea id="knowledge" x-model="promptData.knowledge" rows="4" class="form-textarea"></textarea>
                                        <p class="mt-1 text-xs text-gray-500">Informações cruciais sobre seus produtos, serviços, políticas da empresa, etc.</p>
                                    </div>
                                    <div>
                                        <label for="tone" class="block text-sm font-medium text-gray-700">Tom de Voz</label>
                                        <input type="text" id="tone" x-model="promptData.tone" class="form-input">
                                        <p class="mt-1 text-xs text-gray-500">Como a IA deve se comunicar (ex: profissional, casual, entusiasmado).</p>
                                    </div>
                                    <div>
                                        <label for="instructions" class="block text-sm font-medium text-gray-700">Instruções Específicas</label>
                                        <textarea id="instructions" x-model="promptData.instructions" rows="5" class="form-textarea"></textarea>
                                        <p class="mt-1 text-xs text-gray-500">Comandos diretos para a IA, como técnicas de vendas, o que evitar, como lidar com objeções.</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Exemplos de Interação -->
                            <div class="mb-8">
                                <div class="flex items-center justify-between mb-4">
                                    <h3 class="text-lg font-medium text-gray-900">Exemplos de Interação (Pergunta/Resposta)</h3>
                                    <button @click="addExample" class="px-3 py-1.5 bg-indigo-100 text-indigo-700 rounded-md hover:bg-indigo-200 text-sm">
                                        <i class="fas fa-plus mr-1"></i> Adicionar Exemplo
                                    </button>
                                </div>
                                <div class="space-y-4">
                                    <template x-for="(example, index) in promptData.examples" :key="index">
                                        <div class="p-4 border border-gray-200 rounded-md bg-gray-50">
                                            <div class="flex justify-end mb-2">
                                                <button @click="removeExample(index)" class="text-red-500 hover:text-red-700 text-sm">
                                                    <i class="fas fa-trash-alt mr-1"></i> Remover
                                                </button>
                                            </div>
                                            <div>
                                                <label :for="'example_q_' + index" class="block text-sm font-medium text-gray-700">Pergunta do Cliente</label>
                                                <textarea :id="'example_q_' + index" x-model="example.question" rows="2" class="form-textarea"></textarea>
                                            </div>
                                            <div class="mt-2">
                                                <label :for="'example_a_' + index" class="block text-sm font-medium text-gray-700">Resposta da IA</label>
                                                <textarea :id="'example_a_' + index" x-model="example.answer" rows="3" class="form-textarea"></textarea>
                                            </div>
                                        </div>
                                    </template>
                                    <template x-if="promptData.examples.length === 0">
                                        <p class="text-sm text-gray-500">Nenhum exemplo adicionado. Clique em "Adicionar Exemplo" para começar.</p>
                                    </template>
                                </div>
                            </div>
                            
                            <div class="flex justify-end mb-6">
                                <button @click="savePrompt" :disabled="saving" class="btn-primary">
                                    <template x-if="saving"><i class="fas fa-spinner fa-spin mr-2"></i></template>
                                    Salvar Prompt
                                </button>
                            </div>

                            <!-- Parâmetros Avançados da IA -->
                            <div>
                                <h3 class="text-lg font-medium text-gray-900 mb-4">Parâmetros Avançados da IA</h3>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label for="temperature" class="block text-sm font-medium text-gray-700">Temperatura (<span x-text="aiParams.temperature"></span>)</label>
                                        <input type="range" id="temperature" x-model.number="aiParams.temperature" min="0" max="1" step="0.1" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-indigo-600">
                                        <p class="mt-1 text-xs text-gray-500">Controla a aleatoriedade. Valores mais baixos = mais determinístico.</p>
                                    </div>
                                    <div>
                                        <label for="max_tokens" class="block text-sm font-medium text-gray-700">Máximo de Tokens (<span x-text="aiParams.max_tokens"></span>)</label>
                                        <input type="range" id="max_tokens" x-model.number="aiParams.max_tokens" min="50" max="2048" step="50" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-indigo-600">
                                        <p class="mt-1 text-xs text-gray-500">Comprimento máximo da resposta gerada.</p>
                                    </div>
                                    <div>
                                        <label for="frequency_penalty" class="block text-sm font-medium text-gray-700">Penalidade de Frequência (<span x-text="aiParams.frequency_penalty"></span>)</label>
                                        <input type="range" id="frequency_penalty" x-model.number="aiParams.frequency_penalty" min="0" max="2" step="0.1" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-indigo-600">
                                        <p class="mt-1 text-xs text-gray-500">Reduz a chance de repetir a mesma linha textualmente.</p>
                                    </div>
                                    <div>
                                        <label for="presence_penalty" class="block text-sm font-medium text-gray-700">Penalidade de Presença (<span x-text="aiParams.presence_penalty"></span>)</label>
                 <!-- AI Training Section -->
                <div x-show="activeSection === 'ai_training'" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-data="aiTrainingSection">
                    <div class="space-y-6">
                        <!-- Mensagens de feedback -->
                        <div x-show="success" x-transition class="bg-green-50 border border-green-200 rounded-md p-4">
                            <div class="flex">
                                <div class="flex-shrink-0">
                                    <i class="fas fa-check-circle text-green-400"></i>
                                </div>
                                <div class="ml-3">
                                    <p class="text-sm font-medium text-green-800" x-text="success"></p>
                                </div>
                            </div>
                        </div>

                        <div x-show="error" x-transition class="bg-red-50 border border-red-200 rounded-md p-4">
                            <div class="flex">
                                <div class="flex-shrink-0">
                                    <i class="fas fa-exclamation-circle text-red-400"></i>
                                </div>
                                <div class="ml-3">
                                    <p class="text-sm font-medium text-red-800" x-text="error"></p>
                                </div>
                            </div>
                        </div>

                        <!-- Configuração do Prompt -->
                        <div class="bg-white shadow rounded-lg">
                            <div class="px-6 py-4 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-900">Configuração do Prompt da IA</h3>
                                <p class="mt-1 text-sm text-gray-500">Personalize o comportamento e a personalidade do assistente virtual.</p>
                            </div>
                            <div class="p-6 space-y-6">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Personalidade</label>
                                        <input type="text" x-model="promptData.personality" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Tom de Voz</label>
                                        <select x-model="promptData.tone" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                            <option value="Profissional mas acolhedor">Profissional mas acolhedor</option>
                                            <option value="Casual e amigável">Casual e amigável</option>
                                            <option value="Formal e técnico">Formal e técnico</option>
                                            <option value="Entusiasta e energético">Entusiasta e energético</option>
                                        </select>
                                    </div>
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Conhecimento Base</label>
                                    <textarea x-model="promptData.knowledge" rows="3" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" placeholder="Descreva o conhecimento que a IA deve ter sobre sua empresa, produtos e serviços..."></textarea>
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Instruções Específicas</label>
                                    <textarea x-model="promptData.instructions" rows="4" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" placeholder="Instruções específicas sobre como a IA deve responder e se comportar..."></textarea>
                                </div>

                                <!-- Exemplos de Conversação -->
                                <div>
                                    <div class="flex items-center justify-between mb-4">
                                        <label class="block text-sm font-medium text-gray-700">Exemplos de Conversação</label>
                                        <button @click="addExample" type="button" class="inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-indigo-700 bg-indigo-100 hover:bg-indigo-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                            <i class="fas fa-plus mr-2"></i>
                                            Adicionar Exemplo
                                        </button>
                                    </div>
                                    
                                    <div class="space-y-4">
                                        <template x-for="(example, index) in promptData.examples" :key="index">
                                            <div class="border border-gray-200 rounded-lg p-4">
                                                <div class="flex justify-between items-start mb-3">
                                                    <h4 class="text-sm font-medium text-gray-900" x-text="`Exemplo ${index + 1}`"></h4>
                                                    <button @click="removeExample(index)" type="button" class="text-red-600 hover:text-red-800">
                                                        <i class="fas fa-trash"></i>
                                                    </button>
                                                </div>
                                                <div class="space-y-3">
                                                    <div>
                                                        <label class="block text-xs font-medium text-gray-700">Pergunta do Cliente</label>
                                                        <input type="text" x-model="example.question" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 text-sm">
                                                    </div>
                                                    <div>
                                                        <label class="block text-xs font-medium text-gray-700">Resposta Ideal</label>
                                                        <textarea x-model="example.answer" rows="3" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 text-sm"></textarea>
                                                    </div>
                                                </div>
                                            </div>
                                        </template>
                                    </div>
                                </div>

                                <div class="flex justify-between">
                                    <button @click="resetToDefault" type="button" class="inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                        <i class="fas fa-undo mr-2"></i>
                                        Restaurar Padrão
                                    </button>
                                    <button @click="savePrompt" :disabled="saving" type="button" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50">
                                        <template x-if="saving">
                                            <div class="animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"></div>
                                        </template>
                                        <template x-if="!saving">
                                            <i class="fas fa-save mr-2"></i>
                                        </template>
                                        <span x-text="saving ? 'Salvando...' : 'Salvar Prompt'"></span>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Parâmetros Avançados -->
                        <div class="bg-white shadow rounded-lg">
                            <div class="px-6 py-4 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-900">Parâmetros Avançados</h3>
                                <p class="mt-1 text-sm text-gray-500">Ajuste fino dos parâmetros de geração de texto da IA.</p>
                            </div>
                            <div class="p-6 space-y-6">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Temperatura (Criatividade)</label>
                                        <div class="mt-1 flex items-center space-x-3">
                                            <input type="range" x-model="aiParams.temperature" min="0" max="1" step="0.1" class="flex-1">
                                            <span class="text-sm text-gray-500 w-12" x-text="aiParams.temperature"></span>
                                        </div>
                                        <p class="mt-1 text-xs text-gray-500">0 = Mais conservador, 1 = Mais criativo</p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Máximo de Tokens</label>
                                        <input type="number" x-model="aiParams.max_tokens" min="50" max="2000" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                        <p class="mt-1 text-xs text-gray-500">Limite de palavras por resposta</p>
                                    </div>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Penalidade de Frequência</label>
                                        <div class="mt-1 flex items-center space-x-3">
                                            <input type="range" x-model="aiParams.frequency_penalty" min="0" max="2" step="0.1" class="flex-1">
                                            <span class="text-sm text-gray-500 w-12" x-text="aiParams.frequency_penalty"></span>
                                        </div>
                                        <p class="mt-1 text-xs text-gray-500">Reduz repetição de palavras</p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Penalidade de Presença</label>
                                        <div class="mt-1 flex items-center space-x-3">
                                            <input type="range" x-model="aiParams.presence_penalty" min="0" max="2" step="0.1" class="flex-1">
                                            <span class="text-sm text-gray-500 w-12" x-text="aiParams.presence_penalty"></span>
                                        </div>
                                        <p class="mt-1 text-xs text-gray-500">Incentiva novos tópicos</p>
                                    </div>
                                </div>

                                <div class="flex justify-end">
                                    <button @click="saveParams" :disabled="saving" type="button" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50">
                                        <template x-if="saving">
                                            <div class="animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"></div>
                                        </template>
                                        <template x-if="!saving">
                                            <i class="fas fa-save mr-2"></i>
                                        </template>
                                        <span x-text="saving ? 'Salvando...' : 'Salvar Parâmetros'"></span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Campaigns Section -->
                <div x-show="activeSection === 'campaigns'" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-data="campaignsSection">
                    <div class="space-y-6">
                        <!-- Mensagens de feedback -->
                        <div x-show="success" x-transition class="bg-green-50 border border-green-200 rounded-md p-4">
                            <div class="flex">
                                <div class="flex-shrink-0">
                                    <i class="fas fa-check-circle text-green-400"></i>
                                </div>
                                <div class="ml-3">
                                    <p class="text-sm font-medium text-green-800" x-text="success"></p>
                                </div>
                            </div>
                        </div>

                        <div x-show="error" x-transition class="bg-red-50 border border-red-200 rounded-md p-4">
                            <div class="flex">
                                <div class="flex-shrink-0">
                                    <i class="fas fa-exclamation-circle text-red-400"></i>
                                </div>
                                <div class="ml-3">
                                    <p class="text-sm font-medium text-red-800" x-text="error"></p>
                                </div>
                            </div>
                        </div>

                        <!-- Cabeçalho e filtros -->
                        <div class="bg-white shadow rounded-lg">
                            <div class="px-6 py-4 border-b border-gray-200">
                                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                                    <div>
                                        <h3 class="text-lg font-medium text-gray-900">Campanhas de Marketing</h3>
                                        <p class="mt-1 text-sm text-gray-500">Gerencie suas campanhas de mensagens em massa.</p>
                                    </div>
                                    <div class="mt-4 sm:mt-0">
                                        <button @click="createNewCampaign" type="button" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                            <i class="fas fa-plus mr-2"></i>
                                            Nova Campanha
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Filtros -->
                            <div class="px-6 py-4 bg-gray-50 border-b border-gray-200">
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Status</label>
                                        <select x-model="filters.status" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                            <option value="all">Todos</option>
                                            <option value="active">Ativas</option>
                                            <option value="scheduled">Agendadas</option>
                                            <option value="completed">Concluídas</option>
                                            <option value="draft">Rascunhos</option>
                                        </select>
                                    </div>
                                    <div class="md:col-span-2">
                                        <label class="block text-sm font-medium text-gray-700">Buscar</label>
                                        <input type="text" x-model="filters.search" placeholder="Buscar por nome ou descrição..." class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                    </div>
                                </div>
                            </div>

                            <!-- Lista de campanhas -->
                            <div class="overflow-hidden">
                                <template x-if="loading">
                                    <div class="p-6 text-center">
                                        <div class="inline-block animate-spin rounded-full h-8 w-8 border-4 border-indigo-500 border-t-transparent"></div>
                                        <p class="mt-2 text-sm text-gray-500">Carregando campanhas...</p>
                                    </div>
                                </template>

                                <template x-if="!loading && filteredCampaigns.length === 0">
                                    <div class="p-6 text-center">
                                        <i class="fas fa-bullhorn text-gray-300 text-4xl mb-2"></i>
                                        <p class="text-gray-500">Nenhuma campanha encontrada</p>
                                    </div>
                                </template>

                                <template x-if="!loading && filteredCampaigns.length > 0">
                                    <div class="divide-y divide-gray-200">
                                        <template x-for="campaign in filteredCampaigns" :key="campaign.id">
                                            <div class="p-6 hover:bg-gray-50">
                                                <div class="flex items-center justify-between">
                                                    <div class="flex-1">
                                                        <div class="flex items-center space-x-3">
                                                            <h4 class="text-lg font-medium text-gray-900" x-text="campaign.name"></h4>
                                                            <span :class="getStatusClass(campaign.status)" class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium" x-text="getStatusText(campaign.status)"></span>
                                                        </div>
                                                        <p class="mt-1 text-sm text-gray-500" x-text="campaign.description"></p>
                                                        <div class="mt-2 flex items-center space-x-4 text-sm text-gray-500">
                                                            <span><i class="fas fa-users mr-1"></i><span x-text="getAudienceText(campaign.target_audience)"></span></span>
                                                            <span x-show="campaign.scheduled_date"><i class="fas fa-calendar mr-1"></i><span x-text="formatDate(campaign.scheduled_date)"></span></span>
                                                            <span x-show="campaign.sent_count > 0"><i class="fas fa-paper-plane mr-1"></i><span x-text="campaign.sent_count + ' enviadas'"></span></span>
                                                        </div>
                                                    </div>
                                                    <div class="flex items-center space-x-2">
                                                        <button @click="editCampaign(campaign.id)" class="text-indigo-600 hover:text-indigo-900">
                                                            <i class="fas fa-edit"></i>
                                                        </button>
                                                        <button @click="duplicateCampaign(campaign.id)" class="text-gray-600 hover:text-gray-900">
                                                            <i class="fas fa-copy"></i>
                                                        </button>
                                                        <button @click="deleteCampaign(campaign.id)" class="text-red-600 hover:text-red-900">
                                                            <i class="fas fa-trash"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </template>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <!-- Formulário de nova/editar campanha -->
                        <div x-show="showNewCampaignForm || showEditCampaignForm" x-transition class="bg-white shadow rounded-lg">
                            <div class="px-6 py-4 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-900" x-text="showNewCampaignForm ? 'Nova Campanha' : 'Editar Campanha'"></h3>
                            </div>
                            <div class="p-6 space-y-6">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Nome da Campanha</label>
                                        <input type="text" x-model="currentCampaign.name" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Público-Alvo</label>
                                        <select x-model="currentCampaign.target_audience" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                            <option value="all">Todos os contatos</option>
                                            <option value="new_customers">Novos clientes</option>
                                            <option value="existing_customers">Clientes existentes</option>
                                            <option value="inactive">Clientes inativos</option>
                                        </select>
                                    </div>
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Descrição</label>
                                    <textarea x-model="currentCampaign.description" rows="2" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"></textarea>
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Mensagem</label>
                                    <textarea x-model="currentCampaign.message" rows="4" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" placeholder="Use {nome} para personalizar com o nome do contato"></textarea>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Status</label>
                                        <select x-model="currentCampaign.status" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                            <option value="draft">Rascunho</option>
                                            <option value="scheduled">Agendada</option>
                                            <option value="active">Ativa</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Data de Agendamento</label>
                                        <input type="date" x-model="currentCampaign.scheduled_date" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Horário</label>
                                        <input type="time" x-model="currentCampaign.scheduled_time" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                    </div>
                                </div>

                                <div class="flex justify-between">
                                    <button @click="cancelEdit" type="button" class="inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                        Cancelar
                                    </button>
                                    <button @click="saveCampaign" :disabled="saving" type="button" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50">
                                        <template x-if="saving">
                                            <div class="animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"></div>
                                        </template>
                                        <template x-if="!saving">
                                            <i class="fas fa-save mr-2"></i>
                                        </template>
                                        <span x-text="saving ? 'Salvando...' : 'Salvar Campanha'"></span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Admin Section -->
                <div x-show="activeSection === 'admin'" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-data="adminSection">
                    <div class="space-y-6">
                        <!-- Mensagens de feedback -->
                        <div x-show="success" x-transition class="bg-green-50 border border-green-200 rounded-md p-4">
                            <div class="flex">
                                <div class="flex-shrink-0">
                                    <i class="fas fa-check-circle text-green-400"></i>
                                </div>
                                <div class="ml-3">
                                    <p class="text-sm font-medium text-green-800" x-text="success"></p>
                                </div>
                            </div>
                        </div>

                        <div x-show="error" x-transition class="bg-red-50 border border-red-200 rounded-md p-4">
                            <div class="flex">
                                <div class="flex-shrink-0">
                                    <i class="fas fa-exclamation-circle text-red-400"></i>
                                </div>
                                <div class="ml-3">
                                    <p class="text-sm font-medium text-red-800" x-text="error"></p>
                                </div>
                            </div>
                        </div>

                        <!-- Cabeçalho e filtros -->
                        <div class="bg-white shadow rounded-lg">
                            <div class="px-6 py-4 border-b border-gray-200">
                                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                                    <div>
                                        <h3 class="text-lg font-medium text-gray-900">Gerenciamento de Usuários</h3>
                                        <p class="mt-1 text-sm text-gray-500">Gerencie usuários e suas permissões no sistema.</p>
                                    </div>
                                    <div class="mt-4 sm:mt-0">
                                        <button @click="createNewUser" type="button" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                            <i class="fas fa-user-plus mr-2"></i>
                                            Novo Usuário
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Filtros -->
                            <div class="px-6 py-4 bg-gray-50 border-b border-gray-200">
                                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Papel</label>
                                        <select x-model="filters.role" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                            <option value="all">Todos</option>
                                            <option value="admin">Administradores</option>
                                            <option value="user">Usuários</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Status</label>
                                        <select x-model="filters.status" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                            <option value="all">Todos</option>
                                            <option value="active">Ativos</option>
                                            <option value="inactive">Inativos</option>
                                        </select>
                                    </div>
                                    <div class="md:col-span-2">
                                        <label class="block text-sm font-medium text-gray-700">Buscar</label>
                                        <input type="text" x-model="filters.search" placeholder="Buscar por nome ou email..." class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                    </div>
                                </div>
                            </div>

                            <!-- Lista de usuários -->
                            <div class="overflow-hidden">
                                <template x-if="loading">
                                    <div class="p-6 text-center">
                                        <div class="inline-block animate-spin rounded-full h-8 w-8 border-4 border-indigo-500 border-t-transparent"></div>
                                        <p class="mt-2 text-sm text-gray-500">Carregando usuários...</p>
                                    </div>
                                </template>

                                <template x-if="!loading && filteredUsers.length === 0">
                                    <div class="p-6 text-center">
                                        <i class="fas fa-users text-gray-300 text-4xl mb-2"></i>
                                        <p class="text-gray-500">Nenhum usuário encontrado</p>
                                    </div>
                                </template>

                                <template x-if="!loading && filteredUsers.length > 0">
                                    <div class="overflow-x-auto">
                                        <table class="min-w-full divide-y divide-gray-200">
                                            <thead class="bg-gray-50">
                                                <tr>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Usuário</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Papel</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Plano</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Último Login</th>
                                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ações</th>
                                                </tr>
                                            </thead>
                                            <tbody class="bg-white divide-y divide-gray-200">
                                                <template x-for="user in filteredUsers" :key="user.id">
                                                    <tr class="hover:bg-gray-50">
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <div class="flex items-center">
                                                                <div class="flex-shrink-0 h-10 w-10">
                                                                    <div class="h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center">
                                                                        <span class="text-indigo-600 font-medium" x-text="user.name.split(' ').map(n => n[0]).join('').toUpperCase()"></span>
                                                                    </div>
                                                                </div>
                                                                <div class="ml-4">
                                                                    <div class="text-sm font-medium text-gray-900" x-text="user.name"></div>
                                                                    <div class="text-sm text-gray-500" x-text="user.email"></div>
                                                                </div>
                                                            </div>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span :class="user.is_admin ? 'bg-purple-100 text-purple-800' : 'bg-gray-100 text-gray-800'" class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium" x-text="user.is_admin ? 'Administrador' : 'Usuário'"></span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span :class="getPlanBadgeClass(user.plan)" class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium" x-text="getPlanText(user.plan)"></span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span :class="user.is_active ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'" class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium" x-text="user.is_active ? 'Ativo' : 'Inativo'"></span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500" x-text="formatDate(user.last_login)"></td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2">
                                                            <button @click="editUser(user.id)" class="text-indigo-600 hover:text-indigo-900">
                                                                <i class="fas fa-edit"></i>
                                                            </button>
                                                            <button @click="toggleUserStatus(user.id)" :class="user.is_active ? 'text-red-600 hover:text-red-900' : 'text-green-600 hover:text-green-900'">
                                                                <i :class="user.is_active ? 'fas fa-user-slash' : 'fas fa-user-check'"></i>
                                                            </button>
                                                            <button @click="deleteUser(user.id)" class="text-red-600 hover:text-red-900">
                                                                <i class="fas fa-trash"></i>
                                                            </button>
                                                        </td>
                                                    </tr>
                                                </template>
                                            </tbody>
                                        </table>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <!-- Formulário de novo/editar usuário -->
                        <div x-show="showNewUserForm || showEditUserForm" x-transition class="bg-white shadow rounded-lg">
                            <div class="px-6 py-4 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-900" x-text="showNewUserForm ? 'Novo Usuário' : 'Editar Usuário'"></h3>
                            </div>
                            <div class="p-6 space-y-6">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Nome Completo</label>
                                        <input type="text" x-model="currentUser.name" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Email</label>
                                        <input type="email" x-model="currentUser.email" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                    </div>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Senha</label>
                                        <input type="password" x-model="currentUser.password" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" :placeholder="showEditUserForm ? 'Deixe em branco para manter a senha atual' : 'Mínimo 8 caracteres'">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Confirmar Senha</label>
                                        <input type="password" x-model="currentUser.confirmPassword" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                    </div>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Plano</label>
                                        <select x-model="currentUser.plan" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                            <option value="free">Gratuito</option>
                                            <option value="pro">Profissional</option>
                                            <option value="enterprise">Empresarial</option>
                                        </select>
                                    </div>
                                    <div class="flex items-center">
                                        <input type="checkbox" x-model="currentUser.is_admin" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded">
                                        <label class="ml-2 block text-sm text-gray-900">É Administrador?</label>
                                    </div>
                                    <div class="flex items-center">
                                        <input type="checkbox" x-model="currentUser.is_active" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded">
                                        <label class="ml-2 block text-sm text-gray-900">Usuário Ativo?</label>
                                    </div>
                                </div>

                                <div class="flex justify-between">
                                    <button @click="cancelEdit" type="button" class="inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                        Cancelar
                                    </button>
                                    <button @click="saveUser" :disabled="saving" type="button" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50">
                                        <template x-if="saving">
                                            <div class="animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"></div>
                                        </template>
                                        <template x-if="!saving">
                                            <i class="fas fa-save mr-2"></i>
                                        </template>
                                        <span x-text="saving ? 'Salvando...' : 'Salvar Usuário'"></span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Settings Section -->
                <div x-show="activeSection === 'settings'" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100">
                    <div class="space-y-6">
                        <!-- Configurações do Perfil -->
                        <div class="bg-white shadow rounded-lg">
                            <div class="px-6 py-4 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-900">Configurações do Perfil</h3>
                                <p class="mt-1 text-sm text-gray-500">Gerencie suas informações pessoais e preferências.</p>
                            </div>
                            <div class="p-6 space-y-6">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Nome Completo</label>
                                        <input type="text" value="Usuário Zynapse" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Email</label>
                                        <input type="email" value="usuario@zynapse.com" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                    </div>
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Telefone</label>
                                        <input type="tel" placeholder="(11) 99999-9999" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Empresa</label>
                                        <input type="text" placeholder="Nome da empresa" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                    </div>
                                </div>
                                <div class="flex justify-end">
                                    <button type="button" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                        <i class="fas fa-save mr-2"></i>
                                        Salvar Alterações
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Configurações de Segurança -->
                        <div class="bg-white shadow rounded-lg">
                            <div class="px-6 py-4 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-900">Segurança</h3>
                                <p class="mt-1 text-sm text-gray-500">Altere sua senha e configure opções de segurança.</p>
                            </div>
                            <div class="p-6 space-y-6">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Senha Atual</label>
                                        <input type="password" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700">Nova Senha</label>
                                        <input type="password" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Confirmar Nova Senha</label>
                                    <input type="password" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                </div>
                                <div class="flex justify-end">
                                    <button type="button" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                        <i class="fas fa-key mr-2"></i>
                                        Alterar Senha
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Configurações de Notificações -->
                        <div class="bg-white shadow rounded-lg">
                            <div class="px-6 py-4 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-900">Notificações</h3>
                                <p class="mt-1 text-sm text-gray-500">Configure como você deseja receber notificações.</p>
                            </div>
                            <div class="p-6 space-y-6">
                                <div class="space-y-4">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <h4 class="text-sm font-medium text-gray-900">Novas mensagens</h4>
                                            <p class="text-sm text-gray-500">Receber notificações quando chegarem novas mensagens</p>
                                        </div>
                                        <input type="checkbox" checked class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded">
                                    </div>
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <h4 class="text-sm font-medium text-gray-900">Campanhas concluídas</h4>
                                            <p class="text-sm text-gray-500">Notificar quando campanhas forem concluídas</p>
                                        </div>
                                        <input type="checkbox" checked class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded">
                                    </div>
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <h4 class="text-sm font-medium text-gray-900">Relatórios semanais</h4>
                                            <p class="text-sm text-gray-500">Receber relatórios de desempenho semanalmente</p>
                                        </div>
                                        <input type="checkbox" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded">
                                    </div>
                                </div>
                                <div class="flex justify-end">
                                    <button type="button" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                        <i class="fas fa-save mr-2"></i>
                                        Salvar Preferências
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
             <script src="assets/js/whatsapp.js"></script>
    <script src="assets/js/bot-control.js"></script>
    <script src="assets/js/ai-training.js"></script>
    <script src="assets/js/campaigns.js"></script>
    <script src="assets/js/admin.js"></script>
    <script>
        document.addEventListener('alpine:init', () => {
            Alpine.data('mainApp', () => ({
                mobileMenuOpen: false,
                activeSection: 'dashboard',
                userData: {
                    name: 'Carregando...',
                    email: 'carregando@email.com',
                    is_superuser: false // Default to false, update on load
                },
                menuItems: [
                    { id: 'dashboard', name: 'Dashboard', url: '#', icon: 'fas fa-home' },
                    { id: 'whatsapp', name: 'WhatsApp', url: '#', icon: 'fas fa-comments' },
                    { id: 'bot_control', name: 'Controle do Bot', url: '#', icon: 'fas fa-robot' },
                    { id: 'ai_training', name: 'Treinamento IA', url: '#', icon: 'fas fa-brain' },
                    { id: 'campaigns', name: 'Campanhas', url: '#', icon: 'fas fa-bullhorn' },
                    // Admin menu item will be added dynamically if user is superuser
                    { id: 'settings', name: 'Configurações', url: '#', icon: 'fas fa-cog' }
                ],
                
                init() {
                    this.initCharts();
                    
                    // Verificar autenticação
                    const token = localStorage.getItem('zynapse_token');
                    if (!token) {
                        // Em um ambiente de produção, redirecionar para a página de login
                        // window.location.href = 'login.html'; 
                        console.warn('Token não encontrado. Em produção, redirecionar para login.');
                    }
                    
                    this.loadUserData();
                },
                
                get userInitials() {
                    if (!this.userData.name || this.userData.name === 'Carregando...') return '?';
                    return this.userData.name.split(' ').map(n => n[0]).join('').toUpperCase();
                },
                
                getActiveMenuName() {
                    const activeItem = this.menuItems.find(item => item.id === this.activeSection);
                    return activeItem ? activeItem.name : 'Dashboard';
                },
                
                loadUserData() {
                    // Simulação de carregamento de dados do usuário
                    // Em produção, esta função faria uma chamada à API
                    setTimeout(() => {
                        this.userData = {
                            name: 'Usuário Zynapse',
                            email: 'usuario@zynapse.com',
                            is_superuser: true // Simular superusuário para teste
                        };
                        // Adicionar menu Admin se for superusuário
                        if (this.userData.is_superuser && !this.menuItems.find(item => item.id === 'admin')) {
                            const settingsIndex = this.menuItems.findIndex(item => item.id === 'settings');
                            if (settingsIndex !== -1) {
                                this.menuItems.splice(settingsIndex, 0, { id: 'admin', name: 'Admin', url: '#', icon: 'fas fa-user-shield' });
                            }
                        }
                    }, 1000);
                },
                
                logout() {
                    if (confirm('Tem certeza que deseja sair?')) {
                        localStorage.removeItem('zynapse_token');
                        // Em um ambiente de produção, redirecionar para a página de login
                        // window.location.href = 'login.html';
                        console.log('Usuário deslogado. Em produção, redirecionar para login.');
                        // Simular recarregamento da página ou estado de logout
                        this.userData = { name: 'Carregando...', email: 'carregando@email.com', is_superuser: false };
                        this.activeSection = 'dashboard'; 
                    }
                },
                
                initCharts() {
                    this.$nextTick(() => {
                        const conversationsCtx = document.getElementById('conversationsChart');
                        if (conversationsCtx) {
                            new Chart(conversationsCtx.getContext('2d'), {
                                type: 'line',
                                data: {
                                    labels: ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'],
                                    datasets: [{
                                        label: 'Conversas',
                                        data: [32, 45, 38, 56, 72, 48, 36],
                                        backgroundColor: 'rgba(99, 102, 241, 0.1)',
                                        borderColor: 'rgba(99, 102, 241, 1)',
                                        borderWidth: 2,
                                        tension: 0.3,
                                        pointBackgroundColor: 'rgba(99, 102, 241, 1)'
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    scales: { y: { beginAtZero: true, grid: { drawBorder: false } }, x: { grid: { display: false } } },
                                    plugins: { legend: { display: false } }
                                }
                            });
                        }
                        
                        const campaignsCtx = document.getElementById('campaignsChart');
                        if (campaignsCtx) {
                            new Chart(campaignsCtx.getContext('2d'), {
                                type: 'bar',
                                data: {
                                    labels: ['Promoção Verão', 'Lançamento', 'Pós-venda', 'Reativação'],
                                    datasets: [
                                        { label: 'Abertura', data: [85, 72, 63, 48], backgroundColor: 'rgba(99, 102, 241, 0.8)', borderRadius: 4 },
                                        { label: 'Conversão', data: [32, 45, 18, 12], backgroundColor: 'rgba(16, 185, 129, 0.8)', borderRadius: 4 }
                                    ]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    scales: { y: { beginAtZero: true, grid: { drawBorder: false }, ticks: { callback: value => value + '%' } }, x: { grid: { display: false } } },
                                    plugins: { legend: { position: 'top' } }
                                }
                            });
                        }
                    });
                }
            }));
        });
    </script>
</body>
</html>
